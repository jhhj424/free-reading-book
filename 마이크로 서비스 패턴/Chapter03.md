## 3장 프로세스 간 통신

- 마이크로서비스 아키텍처는 분산 아키텍처이므로 IPC가 중요한 역할을 함
- 서비스 API의 발전 과정을 잘 관리해야함, API 코드가 많이 변경 될 경우 클라이언트가 모두 업그레이드 되기 전까지 신구 버전 둘 다 지원되어야 함
- IPC 기술은 각자 장단점이 있다. 동기, 비동기 패턴이냐는 중요한 설계 결정이고 사용성은 동기가 좋지만 서비스 가용성을 높이려면 비동기 메세징 기반으로 서비스끼리 통신하는 것이 좋다.
- 시스템 전체에 실패 전파 방지 - 동기 프로토콜을 쓰는 서비스 클라이언트가 부분 실패를 처리할 수 있도록 타임아웃을 설정해야하고 회로 차단기(서킷 브레이커)패턴을 통해 실패한 서비스가 호출되지 않도록 블록킹 해야한다.
- 동기 프로토콜을 쓰는 아키텍처는 클라이언트가 서비스 인스턴스의 네트워크 위치를 찾을 수 있게 서비스 디스커버리 장치를 달아 주는게 좋다. 가장 간단한 방법은 배포 플랫폼(서버 쪽 디스커버리 및 서드파티 등록 패턴)에 구현된 서비스 디스커버리 장치를 사용하는 것이다. *ex) 쿠버네티스 플랫폼 내부 디스커버리
- 메시징에서 중요한점은 DB를 원자적으로 업데이트하고 발행하는 일이다. 트랜잭셔널 아웃박스 패턴에 따라 일단 메세지를 DB 트랜잭션의 일부로 DB에 쓰는 것이 좋은 방법이다. 그리고 별도 프로세스가 폴링 발행기 패턴 또는 트랜잭션 로그 테일링 패턴으로 DB에서 메시지 조회 후 메시지 브로커에 발행하면 된다.
